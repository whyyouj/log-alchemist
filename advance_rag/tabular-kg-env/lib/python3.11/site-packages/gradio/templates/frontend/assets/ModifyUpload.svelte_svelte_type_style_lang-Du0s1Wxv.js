import{p as Ce,u as De}from"./index-Xl9iYhYF.js";import"./Index-CdNwo3lV.js";const{SvelteComponent:Pe,append:w,attr:P,detach:te,element:T,flush:G,init:Te,insert:le,noop:Y,safe_not_equal:Ue,set_data:M,set_style:H,space:K,text:W,toggle_class:Z}=window.__gradio__svelte__internal,{onMount:We,createEventDispatcher:je,getContext:qe,onDestroy:Ne}=window.__gradio__svelte__internal;function x(t){let e,n,l,r,o=N(t[2])+"",f,d,s,a,m=t[2].orig_name+"",g;return{c(){e=T("div"),n=T("span"),l=T("div"),r=T("progress"),f=W(o),s=K(),a=T("span"),g=W(m),H(r,"visibility","hidden"),H(r,"height","0"),H(r,"width","0"),r.value=d=N(t[2]),P(r,"max","100"),P(r,"class","svelte-1vsfomn"),P(l,"class","progress-bar svelte-1vsfomn"),P(a,"class","file-name svelte-1vsfomn"),P(e,"class","file svelte-1vsfomn")},m(c,_){le(c,e,_),w(e,n),w(n,l),w(l,r),w(r,f),w(e,s),w(e,a),w(a,g)},p(c,_){_&4&&o!==(o=N(c[2])+"")&&M(f,o),_&4&&d!==(d=N(c[2]))&&(r.value=d),_&4&&m!==(m=c[2].orig_name+"")&&M(g,m)},d(c){c&&te(e)}}}function Ie(t){let e,n,l,r=t[0].length+"",o,f,d=t[0].length>1?"files":"file",s,a,m,g=t[2]&&x(t);return{c(){e=T("div"),n=T("span"),l=W("Uploading "),o=W(r),f=K(),s=W(d),a=W("..."),m=K(),g&&g.c(),P(n,"class","uploading svelte-1vsfomn"),P(e,"class","wrap svelte-1vsfomn"),Z(e,"progress",t[1])},m(c,_){le(c,e,_),w(e,n),w(n,l),w(n,o),w(n,f),w(n,s),w(n,a),w(e,m),g&&g.m(e,null)},p(c,[_]){_&1&&r!==(r=c[0].length+"")&&M(o,r),_&1&&d!==(d=c[0].length>1?"files":"file")&&M(s,d),c[2]?g?g.p(c,_):(g=x(c),g.c(),g.m(e,null)):g&&(g.d(1),g=null),_&2&&Z(e,"progress",c[1])},i:Y,o:Y,d(c){c&&te(e),g&&g.d()}}}function N(t){return t.progress*100/(t.size||0)||0}function Me(t){let e=0;return t.forEach(n=>{e+=N(n)}),document.documentElement.style.setProperty("--upload-progress-width",(e/t.length).toFixed(2)+"%"),e/t.length}function Je(t,e,n){let{upload_id:l}=e,{root:r}=e,{files:o}=e,f,d=!1,s,a,m=o.map(u=>({...u,progress:0}));const g=je();function c(u,h){n(0,m=m.map(z=>(z.orig_name===u&&(z.progress+=h),z)))}const _=qe("EventSource_factory");return We(()=>{f=_(new URL(`${r}/upload_progress?upload_id=${l}`)),f.onmessage=async function(u){const h=JSON.parse(u.data);d||n(1,d=!0),h.msg==="done"?(f.close(),g("done")):(n(6,s=h),c(h.orig_name,h.chunk_size))}}),Ne(()=>{(f!=null||f!=null)&&f.close()}),t.$$set=u=>{"upload_id"in u&&n(3,l=u.upload_id),"root"in u&&n(4,r=u.root),"files"in u&&n(5,o=u.files)},t.$$.update=()=>{t.$$.dirty&1&&Me(m),t.$$.dirty&65&&n(2,a=s||m[0])},[m,d,a,l,r,o,s]}class Le extends Pe{constructor(e){super(),Te(this,e,Je,Ie,Ue,{upload_id:3,root:4,files:5})}get upload_id(){return this.$$.ctx[3]}set upload_id(e){this.$$set({upload_id:e}),G()}get root(){return this.$$.ctx[4]}set root(e){this.$$set({root:e}),G()}get files(){return this.$$.ctx[5]}set files(e){this.$$set({files:e}),G()}}const{SvelteComponent:Oe,append:$,attr:y,binding_callbacks:Re,bubble:S,check_outros:ne,create_component:Be,create_slot:ie,destroy_component:Ge,detach:J,element:Q,empty:re,flush:k,get_all_dirty_from_scope:se,get_slot_changes:oe,group_outros:ae,init:He,insert:L,listen:v,mount_component:Ke,prevent_default:C,run_all:Qe,safe_not_equal:Ve,set_style:ue,space:Xe,stop_propagation:D,toggle_class:b,transition_in:F,transition_out:U,update_slot_base:fe}=window.__gradio__svelte__internal,{createEventDispatcher:Ye,tick:Ze,getContext:xe}=window.__gradio__svelte__internal;function $e(t){let e,n,l,r,o,f,d,s,a,m,g;const c=t[24].default,_=ie(c,t,t[23],null);return{c(){e=Q("button"),_&&_.c(),n=Xe(),l=Q("input"),y(l,"aria-label","file upload"),y(l,"data-testid","file-upload"),y(l,"type","file"),y(l,"accept",r=t[15]||void 0),l.multiple=o=t[6]==="multiple"||void 0,y(l,"webkitdirectory",f=t[6]==="directory"||void 0),y(l,"mozdirectory",d=t[6]==="directory"||void 0),y(l,"class","svelte-j5bxrl"),y(e,"tabindex",s=t[9]?-1:0),y(e,"class","svelte-j5bxrl"),b(e,"hidden",t[9]),b(e,"center",t[4]),b(e,"boundedheight",t[3]),b(e,"flex",t[5]),b(e,"disable_click",t[7]),ue(e,"height","100%")},m(u,h){L(u,e,h),_&&_.m(e,null),$(e,n),$(e,l),t[32](l),a=!0,m||(g=[v(l,"change",t[17]),v(e,"drag",D(C(t[25]))),v(e,"dragstart",D(C(t[26]))),v(e,"dragend",D(C(t[27]))),v(e,"dragover",D(C(t[28]))),v(e,"dragenter",D(C(t[29]))),v(e,"dragleave",D(C(t[30]))),v(e,"drop",D(C(t[31]))),v(e,"click",t[12]),v(e,"drop",t[18]),v(e,"dragenter",t[16]),v(e,"dragleave",t[16])],m=!0)},p(u,h){_&&_.p&&(!a||h[0]&8388608)&&fe(_,c,u,u[23],a?oe(c,u[23],h,null):se(u[23]),null),(!a||h[0]&32768&&r!==(r=u[15]||void 0))&&y(l,"accept",r),(!a||h[0]&64&&o!==(o=u[6]==="multiple"||void 0))&&(l.multiple=o),(!a||h[0]&64&&f!==(f=u[6]==="directory"||void 0))&&y(l,"webkitdirectory",f),(!a||h[0]&64&&d!==(d=u[6]==="directory"||void 0))&&y(l,"mozdirectory",d),(!a||h[0]&512&&s!==(s=u[9]?-1:0))&&y(e,"tabindex",s),(!a||h[0]&512)&&b(e,"hidden",u[9]),(!a||h[0]&16)&&b(e,"center",u[4]),(!a||h[0]&8)&&b(e,"boundedheight",u[3]),(!a||h[0]&32)&&b(e,"flex",u[5]),(!a||h[0]&128)&&b(e,"disable_click",u[7])},i(u){a||(F(_,u),a=!0)},o(u){U(_,u),a=!1},d(u){u&&J(e),_&&_.d(u),t[32](null),m=!1,Qe(g)}}}function et(t){let e,n,l=!t[9]&&ee(t);return{c(){l&&l.c(),e=re()},m(r,o){l&&l.m(r,o),L(r,e,o),n=!0},p(r,o){r[9]?l&&(ae(),U(l,1,1,()=>{l=null}),ne()):l?(l.p(r,o),o[0]&512&&F(l,1)):(l=ee(r),l.c(),F(l,1),l.m(e.parentNode,e))},i(r){n||(F(l),n=!0)},o(r){U(l),n=!1},d(r){r&&J(e),l&&l.d(r)}}}function tt(t){let e,n,l,r,o;const f=t[24].default,d=ie(f,t,t[23],null);return{c(){e=Q("button"),d&&d.c(),y(e,"tabindex",n=t[9]?-1:0),y(e,"class","svelte-j5bxrl"),b(e,"hidden",t[9]),b(e,"center",t[4]),b(e,"boundedheight",t[3]),b(e,"flex",t[5]),ue(e,"height","100%")},m(s,a){L(s,e,a),d&&d.m(e,null),l=!0,r||(o=v(e,"click",t[11]),r=!0)},p(s,a){d&&d.p&&(!l||a[0]&8388608)&&fe(d,f,s,s[23],l?oe(f,s[23],a,null):se(s[23]),null),(!l||a[0]&512&&n!==(n=s[9]?-1:0))&&y(e,"tabindex",n),(!l||a[0]&512)&&b(e,"hidden",s[9]),(!l||a[0]&16)&&b(e,"center",s[4]),(!l||a[0]&8)&&b(e,"boundedheight",s[3]),(!l||a[0]&32)&&b(e,"flex",s[5])},i(s){l||(F(d,s),l=!0)},o(s){U(d,s),l=!1},d(s){s&&J(e),d&&d.d(s),r=!1,o()}}}function ee(t){let e,n;return e=new Le({props:{root:t[8],upload_id:t[13],files:t[14]}}),{c(){Be(e.$$.fragment)},m(l,r){Ke(e,l,r),n=!0},p(l,r){const o={};r[0]&256&&(o.root=l[8]),r[0]&8192&&(o.upload_id=l[13]),r[0]&16384&&(o.files=l[14]),e.$set(o)},i(l){n||(F(e.$$.fragment,l),n=!0)},o(l){U(e.$$.fragment,l),n=!1},d(l){Ge(e,l)}}}function lt(t){let e,n,l,r;const o=[tt,et,$e],f=[];function d(s,a){return s[0]==="clipboard"?0:s[1]&&s[10]?1:2}return e=d(t),n=f[e]=o[e](t),{c(){n.c(),l=re()},m(s,a){f[e].m(s,a),L(s,l,a),r=!0},p(s,a){let m=e;e=d(s),e===m?f[e].p(s,a):(ae(),U(f[m],1,1,()=>{f[m]=null}),ne(),n=f[e],n?n.p(s,a):(n=f[e]=o[e](s),n.c()),F(n,1),n.m(l.parentNode,l))},i(s){r||(F(n),r=!0)},o(s){U(n),r=!1},d(s){s&&J(l),f[e].d(s)}}}function nt(t,e,n){if(!t||t==="*"||t==="file/*"||Array.isArray(t)&&t.some(r=>r==="*"||r==="file/*"))return!0;let l;if(typeof t=="string")l=t.split(",").map(r=>r.trim());else if(Array.isArray(t))l=t;else return!1;return l.includes(e)||l.some(r=>{const[o]=r.split("/").map(f=>f.trim());return r.endsWith("/*")&&n.startsWith(o+"/")})}function it(t,e,n){let{$$slots:l={},$$scope:r}=e,{filetype:o=null}=e,{dragging:f=!1}=e,{boundedheight:d=!0}=e,{center:s=!0}=e,{flex:a=!0}=e,{file_count:m="single"}=e,{disable_click:g=!1}=e,{root:c}=e,{hidden:_=!1}=e,{format:u="file"}=e,{uploading:h=!1}=e,{hidden_upload:z=null}=e,{show_progress:V=!0}=e,{max_file_size:O=null}=e,R,B,j;const de=xe("upload_files"),q=Ye(),_e=["image","video","audio","text","file"],X=i=>i.startsWith(".")||i.endsWith("/*")?i:_e.includes(i)?i+"/*":"."+i;function ce(){n(19,f=!f)}function ge(){navigator.clipboard.read().then(async i=>{for(let p=0;p<i.length;p++){const A=i[p].types.find(E=>E.startsWith("image/"));if(A){i[p].getType(A).then(async E=>{const Se=new File([E],`clipboard.${A.replace("image/","")}`);await I([Se])});break}}})}function he(){g||z&&(n(2,z.value="",z),z.click())}async function me(i){await Ze(),n(13,R=Math.random().toString(36).substring(2,15)),n(1,h=!0);try{const p=await De(i,c,R,O??1/0,de);return q("load",m==="single"?p?.[0]:p),n(1,h=!1),p||[]}catch(p){return q("error",p.message),n(1,h=!1),[]}}async function I(i){if(!i.length)return;let p=i.map(A=>new File([A],A.name,{type:A.type}));return n(14,B=await Ce(p)),await me(B)}async function pe(i){const p=i.target;if(p.files)if(u!="blob")await I(Array.from(p.files));else{if(m==="single"){q("load",p.files[0]);return}q("load",p.files)}}async function be(i){if(n(19,f=!1),!i.dataTransfer?.files)return;const p=Array.from(i.dataTransfer.files).filter(A=>{const E="."+A.name.split(".").pop();return E&&nt(j,E,A.type)||(E&&Array.isArray(o)?o.includes(E):E===o)?!0:(q("error",`Invalid file type only ${o} allowed.`),!1)});await I(p)}function ye(i){S.call(this,t,i)}function ke(i){S.call(this,t,i)}function we(i){S.call(this,t,i)}function ve(i){S.call(this,t,i)}function ze(i){S.call(this,t,i)}function Ae(i){S.call(this,t,i)}function Ee(i){S.call(this,t,i)}function Fe(i){Re[i?"unshift":"push"](()=>{z=i,n(2,z)})}return t.$$set=i=>{"filetype"in i&&n(0,o=i.filetype),"dragging"in i&&n(19,f=i.dragging),"boundedheight"in i&&n(3,d=i.boundedheight),"center"in i&&n(4,s=i.center),"flex"in i&&n(5,a=i.flex),"file_count"in i&&n(6,m=i.file_count),"disable_click"in i&&n(7,g=i.disable_click),"root"in i&&n(8,c=i.root),"hidden"in i&&n(9,_=i.hidden),"format"in i&&n(20,u=i.format),"uploading"in i&&n(1,h=i.uploading),"hidden_upload"in i&&n(2,z=i.hidden_upload),"show_progress"in i&&n(10,V=i.show_progress),"max_file_size"in i&&n(21,O=i.max_file_size),"$$scope"in i&&n(23,r=i.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&1&&(o==null?n(15,j=null):typeof o=="string"?n(15,j=X(o)):(n(0,o=o.map(X)),n(15,j=o.join(", "))))},[o,h,z,d,s,a,m,g,c,_,V,ge,he,R,B,j,ce,pe,be,f,u,O,I,r,l,ye,ke,we,ve,ze,Ae,Ee,Fe]}class ot extends Oe{constructor(e){super(),He(this,e,it,lt,Ve,{filetype:0,dragging:19,boundedheight:3,center:4,flex:5,file_count:6,disable_click:7,root:8,hidden:9,format:20,uploading:1,hidden_upload:2,show_progress:10,max_file_size:21,paste_clipboard:11,open_file_upload:12,load_files:22},null,[-1,-1])}get filetype(){return this.$$.ctx[0]}set filetype(e){this.$$set({filetype:e}),k()}get dragging(){return this.$$.ctx[19]}set dragging(e){this.$$set({dragging:e}),k()}get boundedheight(){return this.$$.ctx[3]}set boundedheight(e){this.$$set({boundedheight:e}),k()}get center(){return this.$$.ctx[4]}set center(e){this.$$set({center:e}),k()}get flex(){return this.$$.ctx[5]}set flex(e){this.$$set({flex:e}),k()}get file_count(){return this.$$.ctx[6]}set file_count(e){this.$$set({file_count:e}),k()}get disable_click(){return this.$$.ctx[7]}set disable_click(e){this.$$set({disable_click:e}),k()}get root(){return this.$$.ctx[8]}set root(e){this.$$set({root:e}),k()}get hidden(){return this.$$.ctx[9]}set hidden(e){this.$$set({hidden:e}),k()}get format(){return this.$$.ctx[20]}set format(e){this.$$set({format:e}),k()}get uploading(){return this.$$.ctx[1]}set uploading(e){this.$$set({uploading:e}),k()}get hidden_upload(){return this.$$.ctx[2]}set hidden_upload(e){this.$$set({hidden_upload:e}),k()}get show_progress(){return this.$$.ctx[10]}set show_progress(e){this.$$set({show_progress:e}),k()}get max_file_size(){return this.$$.ctx[21]}set max_file_size(e){this.$$set({max_file_size:e}),k()}get paste_clipboard(){return this.$$.ctx[11]}get open_file_upload(){return this.$$.ctx[12]}get load_files(){return this.$$.ctx[22]}}export{ot as U};
//# sourceMappingURL=ModifyUpload.svelte_svelte_type_style_lang-Du0s1Wxv.js.map
