import{I as ft,C as wt}from"./Index-CdNwo3lV.js";import{u as vt}from"./Blocks-BZk570BN.js";import{B as dt}from"./BlockLabel-nqmpr3Sz.js";import{E as $t}from"./Empty-DpKdHCs0.js";import{S as kt}from"./ShareButton-DvmCuh5h.js";import{D as It,a as yt}from"./DownloadLink-DaQPcWCF.js";import{I as Oe}from"./Image-Bsh8Umrh.js";import{I as mt}from"./Image-qTpgsDKf.js";import{p as St,u as qt}from"./index-Xl9iYhYF.js";import{W as Ct,S as Dt}from"./SelectSource-CscyKAT-.js";import{D as gt}from"./DropdownArrow-CHSZNAvG.js";import{f as Et}from"./Button-6iwMg6dW.js";import{U as Mt}from"./ModifyUpload.svelte_svelte_type_style_lang-Du0s1Wxv.js";const{SvelteComponent:Wt,append:Ge,attr:N,detach:zt,init:Bt,insert:Nt,noop:De,safe_not_equal:Tt,svg_element:Ee}=window.__gradio__svelte__internal;function Rt(i){let e,n,t;return{c(){e=Ee("svg"),n=Ee("path"),t=Ee("circle"),N(n,"d","M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"),N(t,"cx","12"),N(t,"cy","13"),N(t,"r","4"),N(e,"xmlns","http://www.w3.org/2000/svg"),N(e,"width","100%"),N(e,"height","100%"),N(e,"viewBox","0 0 24 24"),N(e,"fill","none"),N(e,"stroke","currentColor"),N(e,"stroke-width","1.5"),N(e,"stroke-linecap","round"),N(e,"stroke-linejoin","round"),N(e,"class","feather feather-camera")},m(l,r){Nt(l,e,r),Ge(e,n),Ge(e,t)},p:De,i:De,o:De,d(l){l&&zt(e)}}}class Ht extends Wt{constructor(e){super(),Bt(this,e,null,Rt,Tt,{})}}const{SvelteComponent:Ut,append:jt,attr:P,detach:Lt,init:Pt,insert:At,noop:Me,safe_not_equal:Ft,svg_element:Je}=window.__gradio__svelte__internal;function Ot(i){let e,n;return{c(){e=Je("svg"),n=Je("circle"),P(n,"cx","12"),P(n,"cy","12"),P(n,"r","10"),P(e,"xmlns","http://www.w3.org/2000/svg"),P(e,"width","100%"),P(e,"height","100%"),P(e,"viewBox","0 0 24 24"),P(e,"stroke-width","1.5"),P(e,"stroke-linecap","round"),P(e,"stroke-linejoin","round"),P(e,"class","feather feather-circle")},m(t,l){At(t,e,l),jt(e,n)},p:Me,i:Me,o:Me,d(t){t&&Lt(e)}}}class Xt extends Ut{constructor(e){super(),Pt(this,e,null,Ot,Ft,{})}}const{SvelteComponent:Yt,append:Vt,attr:T,detach:Gt,init:Jt,insert:Kt,noop:We,safe_not_equal:Qt,svg_element:Ke}=window.__gradio__svelte__internal;function Zt(i){let e,n;return{c(){e=Ke("svg"),n=Ke("rect"),T(n,"x","3"),T(n,"y","3"),T(n,"width","18"),T(n,"height","18"),T(n,"rx","2"),T(n,"ry","2"),T(e,"xmlns","http://www.w3.org/2000/svg"),T(e,"width","100%"),T(e,"height","100%"),T(e,"viewBox","0 0 24 24"),T(e,"stroke-width","1.5"),T(e,"stroke-linecap","round"),T(e,"stroke-linejoin","round"),T(e,"class","feather feather-square")},m(t,l){Kt(t,e,l),Vt(e,n)},p:We,i:We,o:We,d(t){t&&Gt(e)}}}class xt extends Yt{constructor(e){super(),Jt(this,e,null,Zt,Qt,{})}}const ht=i=>{let e;if(i.currentTarget instanceof Element)e=i.currentTarget.querySelector("img");else return[NaN,NaN];const n=e.getBoundingClientRect(),t=e.naturalWidth/n.width,l=e.naturalHeight/n.height;if(t>l){const u=e.naturalHeight/t,c=(n.height-u)/2;var r=Math.round((i.clientX-n.left)*t),o=Math.round((i.clientY-n.top-c)*t)}else{const u=e.naturalWidth/l,c=(n.width-u)/2;var r=Math.round((i.clientX-n.left-c)*l),o=Math.round((i.clientY-n.top)*l)}return r<0||r>=e.naturalWidth||o<0||o>=e.naturalHeight?null:[r,o]},{SvelteComponent:en,append:Qe,attr:ze,bubble:Ze,check_outros:He,create_component:J,destroy_component:K,detach:oe,element:Be,empty:tn,flush:V,group_outros:Ue,init:nn,insert:ae,listen:ln,mount_component:Q,safe_not_equal:rn,space:je,toggle_class:xe,transition_in:B,transition_out:U}=window.__gradio__svelte__internal,{createEventDispatcher:on}=window.__gradio__svelte__internal;function an(i){let e,n,t,l,r,o,u,c,g,a=i[3]&&et(i),s=i[5]&&tt(i);return o=new mt({props:{src:i[0].url,alt:"",loading:"lazy"}}),{c(){e=Be("div"),a&&a.c(),n=je(),s&&s.c(),t=je(),l=Be("button"),r=Be("div"),J(o.$$.fragment),ze(e,"class","icon-buttons svelte-1l6wqyv"),ze(r,"class","image-container svelte-1l6wqyv"),xe(r,"selectable",i[4]),ze(l,"class","svelte-1l6wqyv")},m(m,b){ae(m,e,b),a&&a.m(e,null),Qe(e,n),s&&s.m(e,null),ae(m,t,b),ae(m,l,b),Qe(l,r),Q(o,r,null),u=!0,c||(g=ln(l,"click",i[7]),c=!0)},p(m,b){m[3]?a?(a.p(m,b),b&8&&B(a,1)):(a=et(m),a.c(),B(a,1),a.m(e,n)):a&&(Ue(),U(a,1,1,()=>{a=null}),He()),m[5]?s?(s.p(m,b),b&32&&B(s,1)):(s=tt(m),s.c(),B(s,1),s.m(e,null)):s&&(Ue(),U(s,1,1,()=>{s=null}),He());const I={};b&1&&(I.src=m[0].url),o.$set(I),(!u||b&16)&&xe(r,"selectable",m[4])},i(m){u||(B(a),B(s),B(o.$$.fragment,m),u=!0)},o(m){U(a),U(s),U(o.$$.fragment,m),u=!1},d(m){m&&(oe(e),oe(t),oe(l)),a&&a.d(),s&&s.d(),K(o),c=!1,g()}}}function sn(i){let e,n;return e=new $t({props:{unpadded_box:!0,size:"large",$$slots:{default:[un]},$$scope:{ctx:i}}}),{c(){J(e.$$.fragment)},m(t,l){Q(e,t,l),n=!0},p(t,l){const r={};l&4096&&(r.$$scope={dirty:l,ctx:t}),e.$set(r)},i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){U(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function et(i){let e,n;return e=new It({props:{href:i[0].url,download:i[0].orig_name||"image",$$slots:{default:[cn]},$$scope:{ctx:i}}}),{c(){J(e.$$.fragment)},m(t,l){Q(e,t,l),n=!0},p(t,l){const r={};l&1&&(r.href=t[0].url),l&1&&(r.download=t[0].orig_name||"image"),l&4160&&(r.$$scope={dirty:l,ctx:t}),e.$set(r)},i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){U(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function cn(i){let e,n;return e=new ft({props:{Icon:yt,label:i[6]("common.download")}}),{c(){J(e.$$.fragment)},m(t,l){Q(e,t,l),n=!0},p(t,l){const r={};l&64&&(r.label=t[6]("common.download")),e.$set(r)},i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){U(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function tt(i){let e,n;return e=new kt({props:{i18n:i[6],formatter:i[8],value:i[0]}}),e.$on("share",i[9]),e.$on("error",i[10]),{c(){J(e.$$.fragment)},m(t,l){Q(e,t,l),n=!0},p(t,l){const r={};l&64&&(r.i18n=t[6]),l&1&&(r.value=t[0]),e.$set(r)},i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){U(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function un(i){let e,n;return e=new Oe({}),{c(){J(e.$$.fragment)},m(t,l){Q(e,t,l),n=!0},i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){U(e.$$.fragment,t),n=!1},d(t){K(e,t)}}}function _n(i){let e,n,t,l,r,o;e=new dt({props:{show_label:i[2],Icon:Oe,label:i[1]||i[6]("image.image")}});const u=[sn,an],c=[];function g(a,s){return a[0]===null||!a[0].url?0:1}return t=g(i),l=c[t]=u[t](i),{c(){J(e.$$.fragment),n=je(),l.c(),r=tn()},m(a,s){Q(e,a,s),ae(a,n,s),c[t].m(a,s),ae(a,r,s),o=!0},p(a,[s]){const m={};s&4&&(m.show_label=a[2]),s&66&&(m.label=a[1]||a[6]("image.image")),e.$set(m);let b=t;t=g(a),t===b?c[t].p(a,s):(Ue(),U(c[b],1,1,()=>{c[b]=null}),He(),l=c[t],l?l.p(a,s):(l=c[t]=u[t](a),l.c()),B(l,1),l.m(r.parentNode,r))},i(a){o||(B(e.$$.fragment,a),B(l),o=!0)},o(a){U(e.$$.fragment,a),U(l),o=!1},d(a){a&&(oe(n),oe(r)),K(e,a),c[t].d(a)}}}function fn(i,e,n){let{value:t}=e,{label:l=void 0}=e,{show_label:r}=e,{show_download_button:o=!0}=e,{selectable:u=!1}=e,{show_share_button:c=!1}=e,{i18n:g}=e;const a=on(),s=_=>{let $=ht(_);$&&a("select",{index:$,value:null})},m=async _=>_?`<img src="${await vt(_,"base64")}" />`:"";function b(_){Ze.call(this,i,_)}function I(_){Ze.call(this,i,_)}return i.$$set=_=>{"value"in _&&n(0,t=_.value),"label"in _&&n(1,l=_.label),"show_label"in _&&n(2,r=_.show_label),"show_download_button"in _&&n(3,o=_.show_download_button),"selectable"in _&&n(4,u=_.selectable),"show_share_button"in _&&n(5,c=_.show_share_button),"i18n"in _&&n(6,g=_.i18n)},[t,l,r,o,u,c,g,s,m,b,I]}class dn extends en{constructor(e){super(),nn(this,e,fn,_n,rn,{value:0,label:1,show_label:2,show_download_button:3,selectable:4,show_share_button:5,i18n:6})}get value(){return this.$$.ctx[0]}set value(e){this.$$set({value:e}),V()}get label(){return this.$$.ctx[1]}set label(e){this.$$set({label:e}),V()}get show_label(){return this.$$.ctx[2]}set show_label(e){this.$$set({show_label:e}),V()}get show_download_button(){return this.$$.ctx[3]}set show_download_button(e){this.$$set({show_download_button:e}),V()}get selectable(){return this.$$.ctx[4]}set selectable(e){this.$$set({selectable:e}),V()}get show_share_button(){return this.$$.ctx[5]}set show_share_button(e){this.$$set({show_share_button:e}),V()}get i18n(){return this.$$.ctx[6]}set i18n(e){this.$$set({i18n:e}),V()}}const ei=dn,{SvelteComponent:mn,append:fe,attr:Ne,create_component:gn,destroy_component:hn,detach:bn,element:Te,init:pn,insert:wn,listen:vn,mount_component:$n,noop:kn,safe_not_equal:In,set_style:yn,space:Sn,text:qn,transition_in:Cn,transition_out:Dn}=window.__gradio__svelte__internal,{createEventDispatcher:En}=window.__gradio__svelte__internal;function Mn(i){let e,n,t,l,r,o="Click to Access Webcam",u,c,g,a;return l=new Ct({}),{c(){e=Te("button"),n=Te("div"),t=Te("span"),gn(l.$$.fragment),r=Sn(),u=qn(o),Ne(t,"class","icon-wrap svelte-qbrfs"),Ne(n,"class","wrap svelte-qbrfs"),Ne(e,"class","svelte-qbrfs"),yn(e,"height","100%")},m(s,m){wn(s,e,m),fe(e,n),fe(n,t),$n(l,t,null),fe(n,r),fe(n,u),c=!0,g||(a=vn(e,"click",i[1]),g=!0)},p:kn,i(s){c||(Cn(l.$$.fragment,s),c=!0)},o(s){Dn(l.$$.fragment,s),c=!1},d(s){s&&bn(e),hn(l),g=!1,a()}}}function Wn(i){const e=En();return[e,()=>e("click")]}class zn extends mn{constructor(e){super(),pn(this,e,Wn,Mn,In,{})}}function Bn(){return navigator.mediaDevices.enumerateDevices()}function Nn(i,e){e.srcObject=i,e.muted=!0,e.play()}async function nt(i,e,n){const t={width:{ideal:1920},height:{ideal:1440}},l={video:n?{deviceId:{exact:n},...t}:t,audio:i};return navigator.mediaDevices.getUserMedia(l).then(r=>(Nn(r,e),r))}function Tn(i){return i.filter(n=>n.kind==="videoinput")}const{SvelteComponent:Rn,action_destroyer:Hn,add_render_callback:Un,append:O,attr:y,binding_callbacks:jn,check_outros:se,create_component:te,create_in_transition:Ln,destroy_component:ne,destroy_each:Pn,detach:R,element:j,empty:Xe,ensure_array_like:lt,flush:G,group_outros:ce,init:An,insert:H,listen:we,mount_component:le,noop:Ye,run_all:Fn,safe_not_equal:On,set_data:bt,set_input_value:Le,space:ue,stop_propagation:Xn,text:pt,toggle_class:de,transition_in:C,transition_out:M}=window.__gradio__svelte__internal,{createEventDispatcher:Yn,onMount:Vn}=window.__gradio__svelte__internal;function it(i,e,n){const t=i.slice();return t[30]=e[n],t}function Gn(i){let e,n,t,l,r,o,u,c,g,a,s;const m=[Qn,Kn],b=[];function I(p,v){return p[1]==="video"||p[0]?0:1}t=I(i),l=b[t]=m[t](i);let _=!i[8]&&rt(i),$=i[10]&&i[7]&&ot(i);return{c(){e=j("div"),n=j("button"),l.c(),o=ue(),_&&_.c(),u=ue(),$&&$.c(),c=Xe(),y(n,"aria-label",r=i[1]==="image"?"capture photo":"start recording"),y(n,"class","svelte-1aa1mud"),y(e,"class","button-wrap svelte-1aa1mud")},m(p,v){H(p,e,v),O(e,n),b[t].m(n,null),O(e,o),_&&_.m(e,null),H(p,u,v),$&&$.m(p,v),H(p,c,v),g=!0,a||(s=we(n,"click",i[13]),a=!0)},p(p,v){let S=t;t=I(p),t===S?b[t].p(p,v):(ce(),M(b[S],1,1,()=>{b[S]=null}),se(),l=b[t],l?l.p(p,v):(l=b[t]=m[t](p),l.c()),C(l,1),l.m(n,null)),(!g||v[0]&2&&r!==(r=p[1]==="image"?"capture photo":"start recording"))&&y(n,"aria-label",r),p[8]?_&&(ce(),M(_,1,1,()=>{_=null}),se()):_?(_.p(p,v),v[0]&256&&C(_,1)):(_=rt(p),_.c(),C(_,1),_.m(e,null)),p[10]&&p[7]?$?($.p(p,v),v[0]&1152&&C($,1)):($=ot(p),$.c(),C($,1),$.m(c.parentNode,c)):$&&(ce(),M($,1,1,()=>{$=null}),se())},i(p){g||(C(l),C(_),C($),g=!0)},o(p){M(l),M(_),M($),g=!1},d(p){p&&(R(e),R(u),R(c)),b[t].d(),_&&_.d(),$&&$.d(p),a=!1,s()}}}function Jn(i){let e,n,t,l;return n=new zn({}),n.$on("click",i[19]),{c(){e=j("div"),te(n.$$.fragment),y(e,"title","grant webcam access")},m(r,o){H(r,e,o),le(n,e,null),l=!0},p:Ye,i(r){l||(C(n.$$.fragment,r),r&&(t||Un(()=>{t=Ln(e,Et,{delay:100,duration:200}),t.start()})),l=!0)},o(r){M(n.$$.fragment,r),l=!1},d(r){r&&R(e),ne(n)}}}function Kn(i){let e,n,t;return n=new Ht({}),{c(){e=j("div"),te(n.$$.fragment),y(e,"class","icon svelte-1aa1mud"),y(e,"title","capture photo")},m(l,r){H(l,e,r),le(n,e,null),t=!0},p:Ye,i(l){t||(C(n.$$.fragment,l),t=!0)},o(l){M(n.$$.fragment,l),t=!1},d(l){l&&R(e),ne(n)}}}function Qn(i){let e,n,t,l;const r=[xn,Zn],o=[];function u(c,g){return c[8]?0:1}return e=u(i),n=o[e]=r[e](i),{c(){n.c(),t=Xe()},m(c,g){o[e].m(c,g),H(c,t,g),l=!0},p(c,g){let a=e;e=u(c),e!==a&&(ce(),M(o[a],1,1,()=>{o[a]=null}),se(),n=o[e],n||(n=o[e]=r[e](c),n.c()),C(n,1),n.m(t.parentNode,t))},i(c){l||(C(n),l=!0)},o(c){M(n),l=!1},d(c){c&&R(t),o[e].d(c)}}}function Zn(i){let e,n,t;return n=new Xt({}),{c(){e=j("div"),te(n.$$.fragment),y(e,"class","icon red svelte-1aa1mud"),y(e,"title","start recording")},m(l,r){H(l,e,r),le(n,e,null),t=!0},i(l){t||(C(n.$$.fragment,l),t=!0)},o(l){M(n.$$.fragment,l),t=!1},d(l){l&&R(e),ne(n)}}}function xn(i){let e,n,t;return n=new xt({}),{c(){e=j("div"),te(n.$$.fragment),y(e,"class","icon red svelte-1aa1mud"),y(e,"title","stop recording")},m(l,r){H(l,e,r),le(n,e,null),t=!0},i(l){t||(C(n.$$.fragment,l),t=!0)},o(l){M(n.$$.fragment,l),t=!1},d(l){l&&R(e),ne(n)}}}function rt(i){let e,n,t,l,r;return n=new gt({}),{c(){e=j("button"),te(n.$$.fragment),y(e,"class","icon svelte-1aa1mud"),y(e,"aria-label","select input source")},m(o,u){H(o,e,u),le(n,e,null),t=!0,l||(r=we(e,"click",i[20]),l=!0)},p:Ye,i(o){t||(C(n.$$.fragment,o),t=!0)},o(o){M(n.$$.fragment,o),t=!1},d(o){o&&R(e),ne(n),l=!1,r()}}}function ot(i){let e,n,t,l,r,o,u;t=new gt({});function c(s,m){return s[6].length===0?tl:el}let g=c(i),a=g(i);return{c(){e=j("select"),n=j("button"),te(t.$$.fragment),l=ue(),a.c(),y(n,"class","inset-icon svelte-1aa1mud"),y(e,"class","select-wrap svelte-1aa1mud"),y(e,"aria-label","select source")},m(s,m){H(s,e,m),O(e,n),le(t,n,null),O(n,l),a.m(e,null),r=!0,o||(u=[we(n,"click",Xn(i[21])),Hn(Ve.call(null,e,i[14])),we(e,"change",i[11])],o=!0)},p(s,m){g===(g=c(s))&&a?a.p(s,m):(a.d(1),a=g(s),a&&(a.c(),a.m(e,null)))},i(s){r||(C(t.$$.fragment,s),r=!0)},o(s){M(t.$$.fragment,s),r=!1},d(s){s&&R(e),ne(t),a.d(),o=!1,Fn(u)}}}function el(i){let e,n=lt(i[6]),t=[];for(let l=0;l<n.length;l+=1)t[l]=at(it(i,n,l));return{c(){for(let l=0;l<t.length;l+=1)t[l].c();e=Xe()},m(l,r){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(l,r);H(l,e,r)},p(l,r){if(r[0]&192){n=lt(l[6]);let o;for(o=0;o<n.length;o+=1){const u=it(l,n,o);t[o]?t[o].p(u,r):(t[o]=at(u),t[o].c(),t[o].m(e.parentNode,e))}for(;o<t.length;o+=1)t[o].d(1);t.length=n.length}},d(l){l&&R(e),Pn(t,l)}}}function tl(i){let e,n=i[3]("common.no_devices")+"",t;return{c(){e=j("option"),t=pt(n),e.__value="",Le(e,e.__value),y(e,"class","svelte-1aa1mud")},m(l,r){H(l,e,r),O(e,t)},p(l,r){r[0]&8&&n!==(n=l[3]("common.no_devices")+"")&&bt(t,n)},d(l){l&&R(e)}}}function at(i){let e,n=i[30].label+"",t,l,r,o;return{c(){e=j("option"),t=pt(n),l=ue(),e.__value=r=i[30].deviceId,Le(e,e.__value),e.selected=o=i[7].deviceId===i[30].deviceId,y(e,"class","svelte-1aa1mud")},m(u,c){H(u,e,c),O(e,t),O(e,l)},p(u,c){c[0]&64&&n!==(n=u[30].label+"")&&bt(t,n),c[0]&64&&r!==(r=u[30].deviceId)&&(e.__value=r,Le(e,e.__value)),c[0]&192&&o!==(o=u[7].deviceId===u[30].deviceId)&&(e.selected=o)},d(u){u&&R(e)}}}function nl(i){let e,n,t,l,r,o;const u=[Jn,Gn],c=[];function g(a,s){return a[9]?1:0}return l=g(i),r=c[l]=u[l](i),{c(){e=j("div"),n=j("video"),t=ue(),r.c(),y(n,"class","svelte-1aa1mud"),de(n,"flip",i[2]),de(n,"hide",!i[9]),y(e,"class","wrap svelte-1aa1mud")},m(a,s){H(a,e,s),O(e,n),i[18](n),O(e,t),c[l].m(e,null),o=!0},p(a,s){(!o||s[0]&4)&&de(n,"flip",a[2]),(!o||s[0]&512)&&de(n,"hide",!a[9]);let m=l;l=g(a),l===m?c[l].p(a,s):(ce(),M(c[m],1,1,()=>{c[m]=null}),se(),r=c[l],r?r.p(a,s):(r=c[l]=u[l](a),r.c()),C(r,1),r.m(e,null))},i(a){o||(C(r),o=!0)},o(a){M(r),o=!1},d(a){a&&R(e),i[18](null),c[l].d()}}}function Ve(i,e){const n=t=>{i&&!i.contains(t.target)&&!t.defaultPrevented&&e(t)};return document.addEventListener("click",n,!0),{destroy(){document.removeEventListener("click",n,!0)}}}function ll(i,e,n){let t,l=[],r=null,o,{streaming:u=!1}=e,{pending:c=!1}=e,{root:g=""}=e,{mode:a="image"}=e,{mirror_webcam:s}=e,{include_audio:m}=e,{i18n:b}=e;const I=Yn();Vn(()=>o=document.createElement("canvas"));const _=async h=>{const F=h.target.value;await nt(m,t,F).then(async ie=>{D=ie,n(7,r=l.find(re=>re.deviceId===F)||null),n(10,E=!1)})};async function $(){try{nt(m,t).then(async h=>{n(9,w=!0),n(6,l=await Bn()),D=h}).then(()=>Tn(l)).then(h=>{n(6,l=h);const W=D.getTracks().map(F=>F.getSettings()?.deviceId)[0];n(7,r=W&&h.find(F=>F.deviceId===W)||l[0])}),(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)&&I("error",b("image.no_webcam_support"))}catch(h){if(h instanceof DOMException&&h.name=="NotAllowedError")I("error",b("image.allow_webcam_access"));else throw h}}function p(){var h=o.getContext("2d");(!u||u&&v)&&t.videoWidth&&t.videoHeight&&(o.width=t.videoWidth,o.height=t.videoHeight,h.drawImage(t,0,0,t.videoWidth,t.videoHeight),s&&(h.scale(-1,1),h.drawImage(t,-t.videoWidth,0)),o.toBlob(W=>{I(u?"stream":"capture",W)},"image/png",.8))}let v=!1,S=[],D,A,k;function f(){if(v){k.stop();let h=new Blob(S,{type:A}),W=new FileReader;W.onload=async function(F){if(F.target){let ie=new File([h],"sample."+A.substring(6));const re=await St([ie]);let Ce=(await qt(re,g))?.filter(Boolean)[0];I("capture",Ce),I("stop_recording")}},W.readAsDataURL(h)}else{I("start_recording"),S=[];let h=["video/webm","video/mp4"];for(let W of h)if(MediaRecorder.isTypeSupported(W)){A=W;break}if(A===null){console.error("No supported MediaRecorder mimeType");return}k=new MediaRecorder(D,{mimeType:A}),k.addEventListener("dataavailable",function(W){S.push(W.data)}),k.start(200)}n(8,v=!v)}let w=!1;function X(){a==="image"&&u&&n(8,v=!v),a==="image"?p():f(),!v&&D&&(D.getTracks().forEach(h=>h.stop()),n(5,t.srcObject=null,t),n(9,w=!1))}u&&a==="image"&&window.setInterval(()=>{t&&!c&&p()},500);let E=!1;function Y(h){h.preventDefault(),h.stopPropagation(),n(10,E=!1)}function Ie(h){jn[h?"unshift":"push"](()=>{t=h,n(5,t)})}const ye=async()=>$(),Se=()=>n(10,E=!0),qe=()=>n(10,E=!1);return i.$$set=h=>{"streaming"in h&&n(0,u=h.streaming),"pending"in h&&n(15,c=h.pending),"root"in h&&n(16,g=h.root),"mode"in h&&n(1,a=h.mode),"mirror_webcam"in h&&n(2,s=h.mirror_webcam),"include_audio"in h&&n(17,m=h.include_audio),"i18n"in h&&n(3,b=h.i18n)},[u,a,s,b,Ve,t,l,r,v,w,E,_,$,X,Y,c,g,m,Ie,ye,Se,qe]}class il extends Rn{constructor(e){super(),An(this,e,ll,nl,On,{streaming:0,pending:15,root:16,mode:1,mirror_webcam:2,include_audio:17,i18n:3,click_outside:4},null,[-1,-1])}get streaming(){return this.$$.ctx[0]}set streaming(e){this.$$set({streaming:e}),G()}get pending(){return this.$$.ctx[15]}set pending(e){this.$$set({pending:e}),G()}get root(){return this.$$.ctx[16]}set root(e){this.$$set({root:e}),G()}get mode(){return this.$$.ctx[1]}set mode(e){this.$$set({mode:e}),G()}get mirror_webcam(){return this.$$.ctx[2]}set mirror_webcam(e){this.$$set({mirror_webcam:e}),G()}get include_audio(){return this.$$.ctx[17]}set include_audio(e){this.$$set({include_audio:e}),G()}get i18n(){return this.$$.ctx[3]}set i18n(e){this.$$set({i18n:e}),G()}get click_outside(){return Ve}}const rl=il,{SvelteComponent:ol,attr:al,create_component:sl,destroy_component:cl,detach:ul,element:_l,init:fl,insert:dl,mount_component:ml,noop:gl,safe_not_equal:hl,transition_in:bl,transition_out:pl}=window.__gradio__svelte__internal,{createEventDispatcher:wl}=window.__gradio__svelte__internal;function vl(i){let e,n,t;return n=new ft({props:{Icon:wt,label:"Remove Image"}}),n.$on("click",i[1]),{c(){e=_l("div"),sl(n.$$.fragment),al(e,"class","svelte-s6ybro")},m(l,r){dl(l,e,r),ml(n,e,null),t=!0},p:gl,i(l){t||(bl(n.$$.fragment,l),t=!0)},o(l){pl(n.$$.fragment,l),t=!1},d(l){l&&ul(e),cl(n)}}}function $l(i){const e=wl();return[e,t=>{e("remove_image"),t.stopPropagation()}]}class kl extends ol{constructor(e){super(),fl(this,e,$l,vl,hl,{})}}const{SvelteComponent:Il,add_flush_callback:Pe,append:me,attr:he,bind:Ae,binding_callbacks:ve,bubble:Re,check_outros:be,create_component:Z,create_slot:yl,destroy_component:x,detach:$e,element:Fe,empty:Sl,flush:L,get_all_dirty_from_scope:ql,get_slot_changes:Cl,group_outros:pe,init:Dl,insert:ke,listen:El,mount_component:ee,noop:Ml,safe_not_equal:Wl,space:ge,toggle_class:st,transition_in:q,transition_out:z,update_slot_base:zl}=window.__gradio__svelte__internal,{createEventDispatcher:Bl,tick:Nl}=window.__gradio__svelte__internal;function ct(i){let e,n;return e=new kl({}),e.$on("remove_image",i[23]),{c(){Z(e.$$.fragment)},m(t,l){ee(e,t,l),n=!0},p:Ml,i(t){n||(q(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){x(e,t)}}}function ut(i){let e;const n=i[22].default,t=yl(n,i,i[34],null);return{c(){t&&t.c()},m(l,r){t&&t.m(l,r),e=!0},p(l,r){t&&t.p&&(!e||r[1]&8)&&zl(t,n,l,l[34],e?Cl(n,l[34],r,null):ql(l[34]),null)},i(l){e||(q(t,l),e=!0)},o(l){z(t,l),e=!1},d(l){t&&t.d(l)}}}function Tl(i){let e,n,t=i[1]===null&&ut(i);return{c(){t&&t.c(),e=Sl()},m(l,r){t&&t.m(l,r),ke(l,e,r),n=!0},p(l,r){l[1]===null?t?(t.p(l,r),r[0]&2&&q(t,1)):(t=ut(l),t.c(),q(t,1),t.m(e.parentNode,e)):t&&(pe(),z(t,1,1,()=>{t=null}),be())},i(l){n||(q(t),n=!0)},o(l){z(t),n=!1},d(l){l&&$e(e),t&&t.d(l)}}}function Rl(i){let e,n,t,l,r;return n=new mt({props:{src:i[1].url,alt:i[1].alt_text}}),{c(){e=Fe("div"),Z(n.$$.fragment),he(e,"class","image-frame svelte-rrgd5g"),st(e,"selectable",i[7])},m(o,u){ke(o,e,u),ee(n,e,null),t=!0,l||(r=El(e,"click",i[19]),l=!0)},p(o,u){const c={};u[0]&2&&(c.src=o[1].url),u[0]&2&&(c.alt=o[1].alt_text),n.$set(c),(!t||u[0]&128)&&st(e,"selectable",o[7])},i(o){t||(q(n.$$.fragment,o),t=!0)},o(o){z(n.$$.fragment,o),t=!1},d(o){o&&$e(e),x(n),l=!1,r()}}}function Hl(i){let e,n;return e=new rl({props:{root:i[8],mirror_webcam:i[6],streaming:i[5],mode:"image",include_audio:!1,i18n:i[9]}}),e.$on("capture",i[28]),e.$on("stream",i[29]),e.$on("error",i[30]),e.$on("drag",i[31]),e.$on("upload",i[32]),{c(){Z(e.$$.fragment)},m(t,l){ee(e,t,l),n=!0},p(t,l){const r={};l[0]&256&&(r.root=t[8]),l[0]&64&&(r.mirror_webcam=t[6]),l[0]&32&&(r.streaming=t[5]),l[0]&512&&(r.i18n=t[9]),e.$set(r)},i(t){n||(q(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){x(e,t)}}}function _t(i){let e,n,t;function l(o){i[33](o)}let r={sources:i[4],handle_clear:i[16],handle_select:i[20]};return i[0]!==void 0&&(r.active_source=i[0]),e=new Dt({props:r}),ve.push(()=>Ae(e,"active_source",l)),{c(){Z(e.$$.fragment)},m(o,u){ee(e,o,u),t=!0},p(o,u){const c={};u[0]&16&&(c.sources=o[4]),!n&&u[0]&1&&(n=!0,c.active_source=o[0],Pe(()=>n=!1)),e.$set(c)},i(o){t||(q(e.$$.fragment,o),t=!0)},o(o){z(e.$$.fragment,o),t=!1},d(o){x(e,o)}}}function Ul(i){let e,n,t,l,r,o,u,c,g,a,s,m,b=i[4].length>1||i[4].includes("clipboard"),I;e=new dt({props:{show_label:i[3],Icon:Oe,label:i[2]||"Image"}});let _=i[1]?.url&&!i[13]&&ct(i);function $(f){i[25](f)}function p(f){i[26](f)}let v={hidden:i[1]!==null||i[0]==="webcam",filetype:i[0]==="clipboard"?"clipboard":"image/*",root:i[8],max_file_size:i[10],disable_click:!i[4].includes("upload"),$$slots:{default:[Tl]},$$scope:{ctx:i}};i[11]!==void 0&&(v.uploading=i[11]),i[12]!==void 0&&(v.dragging=i[12]),o=new Mt({props:v}),i[24](o),ve.push(()=>Ae(o,"uploading",$)),ve.push(()=>Ae(o,"dragging",p)),o.$on("load",i[15]),o.$on("error",i[27]);const S=[Hl,Rl],D=[];function A(f,w){return f[0]==="webcam"&&(f[5]||!f[5]&&!f[1])?0:f[1]!==null&&!f[5]?1:-1}~(a=A(i))&&(s=D[a]=S[a](i));let k=b&&_t(i);return{c(){Z(e.$$.fragment),n=ge(),t=Fe("div"),_&&_.c(),l=ge(),r=Fe("div"),Z(o.$$.fragment),g=ge(),s&&s.c(),m=ge(),k&&k.c(),he(r,"class","upload-container svelte-rrgd5g"),he(t,"data-testid","image"),he(t,"class","image-container svelte-rrgd5g")},m(f,w){ee(e,f,w),ke(f,n,w),ke(f,t,w),_&&_.m(t,null),me(t,l),me(t,r),ee(o,r,null),me(r,g),~a&&D[a].m(r,null),me(t,m),k&&k.m(t,null),I=!0},p(f,w){const X={};w[0]&8&&(X.show_label=f[3]),w[0]&4&&(X.label=f[2]||"Image"),e.$set(X),f[1]?.url&&!f[13]?_?(_.p(f,w),w[0]&8194&&q(_,1)):(_=ct(f),_.c(),q(_,1),_.m(t,l)):_&&(pe(),z(_,1,1,()=>{_=null}),be());const E={};w[0]&3&&(E.hidden=f[1]!==null||f[0]==="webcam"),w[0]&1&&(E.filetype=f[0]==="clipboard"?"clipboard":"image/*"),w[0]&256&&(E.root=f[8]),w[0]&1024&&(E.max_file_size=f[10]),w[0]&16&&(E.disable_click=!f[4].includes("upload")),w[0]&2|w[1]&8&&(E.$$scope={dirty:w,ctx:f}),!u&&w[0]&2048&&(u=!0,E.uploading=f[11],Pe(()=>u=!1)),!c&&w[0]&4096&&(c=!0,E.dragging=f[12],Pe(()=>c=!1)),o.$set(E);let Y=a;a=A(f),a===Y?~a&&D[a].p(f,w):(s&&(pe(),z(D[Y],1,1,()=>{D[Y]=null}),be()),~a?(s=D[a],s?s.p(f,w):(s=D[a]=S[a](f),s.c()),q(s,1),s.m(r,null)):s=null),w[0]&16&&(b=f[4].length>1||f[4].includes("clipboard")),b?k?(k.p(f,w),w[0]&16&&q(k,1)):(k=_t(f),k.c(),q(k,1),k.m(t,null)):k&&(pe(),z(k,1,1,()=>{k=null}),be())},i(f){I||(q(e.$$.fragment,f),q(_),q(o.$$.fragment,f),q(s),q(k),I=!0)},o(f){z(e.$$.fragment,f),z(_),z(o.$$.fragment,f),z(s),z(k),I=!1},d(f){f&&($e(n),$e(t)),x(e,f),_&&_.d(),i[24](null),x(o),~a&&D[a].d(),k&&k.d()}}}function jl(i,e,n){let t,{$$slots:l={},$$scope:r}=e,{value:o}=e,{label:u=void 0}=e,{show_label:c}=e,{sources:g=["upload","clipboard","webcam"]}=e,{streaming:a=!1}=e,{pending:s=!1}=e,{mirror_webcam:m}=e,{selectable:b=!1}=e,{root:I}=e,{i18n:_}=e,{max_file_size:$=null}=e,p,v=!1,{active_source:S=null}=e;function D({detail:d}){n(1,o=d),f("upload")}function A(){n(1,o=null),f("clear"),f("change",null)}async function k(d){n(21,s=!0);const _e=await p.load_files([new File([d],"webcam.png")]);n(1,o=_e?.[0]||null),await Nl(),f(a?"stream":"change"),n(21,s=!1)}const f=Bl();let w=!1;function X(d){let _e=ht(d);_e&&f("select",{index:_e,value:null})}async function E(d){switch(d){case"clipboard":p.paste_clipboard();break}}const Y=()=>{n(1,o=null),f("clear")};function Ie(d){ve[d?"unshift":"push"](()=>{p=d,n(14,p)})}function ye(d){v=d,n(11,v)}function Se(d){w=d,n(12,w)}function qe(d){Re.call(this,i,d)}const h=d=>k(d.detail),W=d=>k(d.detail);function F(d){Re.call(this,i,d)}function ie(d){Re.call(this,i,d)}const re=d=>k(d.detail);function Ce(d){S=d,n(0,S),n(4,g)}return i.$$set=d=>{"value"in d&&n(1,o=d.value),"label"in d&&n(2,u=d.label),"show_label"in d&&n(3,c=d.show_label),"sources"in d&&n(4,g=d.sources),"streaming"in d&&n(5,a=d.streaming),"pending"in d&&n(21,s=d.pending),"mirror_webcam"in d&&n(6,m=d.mirror_webcam),"selectable"in d&&n(7,b=d.selectable),"root"in d&&n(8,I=d.root),"i18n"in d&&n(9,_=d.i18n),"max_file_size"in d&&n(10,$=d.max_file_size),"active_source"in d&&n(0,S=d.active_source),"$$scope"in d&&n(34,r=d.$$scope)},i.$$.update=()=>{i.$$.dirty[0]&17&&!S&&g&&n(0,S=g[0]),i.$$.dirty[0]&33&&n(13,t=a&&S==="webcam"),i.$$.dirty[0]&10240&&v&&!t&&n(1,o=null),i.$$.dirty[0]&4096&&f("drag",w)},[S,o,u,c,g,a,m,b,I,_,$,v,w,t,p,D,A,k,f,X,E,s,l,Y,Ie,ye,Se,qe,h,W,F,ie,re,Ce,r]}class Ll extends Il{constructor(e){super(),Dl(this,e,jl,Ul,Wl,{value:1,label:2,show_label:3,sources:4,streaming:5,pending:21,mirror_webcam:6,selectable:7,root:8,i18n:9,max_file_size:10,active_source:0},null,[-1,-1])}get value(){return this.$$.ctx[1]}set value(e){this.$$set({value:e}),L()}get label(){return this.$$.ctx[2]}set label(e){this.$$set({label:e}),L()}get show_label(){return this.$$.ctx[3]}set show_label(e){this.$$set({show_label:e}),L()}get sources(){return this.$$.ctx[4]}set sources(e){this.$$set({sources:e}),L()}get streaming(){return this.$$.ctx[5]}set streaming(e){this.$$set({streaming:e}),L()}get pending(){return this.$$.ctx[21]}set pending(e){this.$$set({pending:e}),L()}get mirror_webcam(){return this.$$.ctx[6]}set mirror_webcam(e){this.$$set({mirror_webcam:e}),L()}get selectable(){return this.$$.ctx[7]}set selectable(e){this.$$set({selectable:e}),L()}get root(){return this.$$.ctx[8]}set root(e){this.$$set({root:e}),L()}get i18n(){return this.$$.ctx[9]}set i18n(e){this.$$set({i18n:e}),L()}get max_file_size(){return this.$$.ctx[10]}set max_file_size(e){this.$$set({max_file_size:e}),L()}get active_source(){return this.$$.ctx[0]}set active_source(e){this.$$set({active_source:e}),L()}}const ti=Ll;export{ti as I,ei as S,rl as W};
//# sourceMappingURL=ImageUploader-CedBHTez.js.map
